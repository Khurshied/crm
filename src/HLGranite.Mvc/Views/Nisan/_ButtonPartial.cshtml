@model HLGranite.Mvc.Models.Nisan
<script>
    function setStatus(status) {
        // TODO: Fail $(this).css("background", "#ccc");
        $("#StatusId option").each(function () {
            if ($(this).html() == status) {
                $(this).attr("selected", true);
                return;
            }
        });
    }

    $(function () {

        $("#edit").click(function () {
            $(this).css("background", "#ccc");
            $("#body input").each(function () {
                $(this).removeAttr("readonly");
            });
            $("#body textarea").each(function () {
                $(this).removeAttr("readonly");
            });
        });

        $("#design").click(function() {
            var assignee = $("#login a").html().trim();
            $("#AssigneeId option").each(function(i, option) {
                if ($(option).text().trim() == assignee) {
                    $(option).attr("selected", "selected");
                    return;
                }
            });
        });
    });
</script>

@functions{
    public string toLower(string sender)
    {
        return sender.ToLower();
    }
}

<p>
    @{
        if(Model.StatusId > 0)
        {
            <input id="edit" type="button" value="Edit" />
        }
        
        var statuses = new HLGranite.Mvc.Models.hlgraniteEntities().Statuses.Where(s => s.StockTypeId == HLGranite.Mvc.Models.StockType.NISAN_TYPE_ID);
        int i = 0;
        foreach (var status in statuses)
        {
            if (Model.StatusId == 0 && i == 2)
            {
                break;
            }
            
            if (status.Id == Model.StatusId)
            {
                <input id="@toLower(status.Name)" type="submit" value="@status.Name" style="background: #ccc");" />
            }

            if (status.Id > Model.StatusId)
            {
                <input id="@toLower(status.Name)" type="submit" value="@status.Name" onclick="setStatus('@status.Name');" />
            }
            i++;
        }
    }
</p>
